<%- include('./template/header'); -%>

    <div class="row">
        <div class="col-lg-10">

        </div>
        <!-- <div class="col-lg-2">
            <div class="col-lg-12">
                <div class="card-body pb-0">
                    <div class="col-xxl-12 mb-3 text-end ">
                        <div class="btn btn-success " id="search"><i class="fas fa-check me-2 "></i>ยอมรับ</div>
                    </div>
                </div>
            </div>
        </div> -->
    </div>
    </div>
    </div>
    <div class="row ">
        <div class="col-lg-12 ">
            <div class="card shadow-sm " style="min-height: 400px; ">
                <div class="card-head">
                    <div class="text-center">
                        <h3>แจ้งเตือนการยืมและคืนอุปกรณ์</h3>
                    </div>

                </div>
                <div class="card-body ">
                    <table class="table table-striped " id="table_id">
                        <thead class="table-navy-blue ">
                            <tr>
                                <th class="text-center ">วันที่</th>
                                <th class="text-center ">รหัสพนักงาน</th>
                                <th class="text-center ">ชื่อ-นามสกุล</th>
                                <th class="text-center ">รายการยืม</th>
                                <th class="text-center ">เลขครุภัณฑ์</th>
                                <th class="text-center ">เวลา</th>
                                <th class="text-center ">ตำแหน่ง</th>
                                <th class="text-center ">สถานะ</th>
                                <th class="text-center ">ยอมรับ</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <%- include('./template/footer'); -%>

        <script>
            var Feature = (function() {
                var startDate = $('#start_date').datepicker();
                var endDate = $('#end_date').datepicker();
                var dataTable = $('#table_id').DataTable({
                    searching: false,
                    responsive: true,
                    ordering: false,
                    lengthChange: false,
                    iDisplayLength: 10,
                    bAutoWidth: false,
                    columns: [{
                        data: function(data) {
                            var date_data = data['borrow_date'];
                            var time = new Date(date_data).toLocaleDateString('th', {
                                timeZone: 'Asia/Jakarta'
                            });
                            console.log(date_data);
                            console.log(time);
                            return time;
                            console.log(str);
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            return data['username'];
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            return data['firstname'] + " " + data['lastname'];
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            return data['equipment_name'];
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            return data['equipment_number'];
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            var date_data = data['borrow_date'];
                            var time = new Date(date_data).toLocaleTimeString('th', {
                                timeStyle: 'short',
                                hour12: false,
                                timeZone: 'Asia/Jakarta'
                            });
                            var date_string = time;
                            return date_string + " " + "น.";
                            console.log(str);
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            return data['department_name'];
                        },
                        className: 'text-center',
                    }, {
                        data: function(data) {
                            return data['status'];
                        },
                        className: 'text-center',
                    }, ],
                    serverSide: true,
                    ajaxSource: '/notification/GetReadNotify',
                    serverData: function(sSource, aaData, fnCallback, oSettings) {
                        aaData.push({
                            "name": "reportID",
                            "value": ""
                        });

                        oSettings.jqXHR = $.ajax({
                            dataType: 'json',
                            type: "POST",
                            url: sSource,
                            data: aaData,
                            success: function(response) {
                                console.log(response);
                                console.log(response);
                                if (response.status === "Succeed") {
                                    var response = response.data;
                                    response = {
                                        "aaData": response,
                                        "iTotalRecords": response.length,
                                        "iTotalDisplayRecords": response.length
                                    };
                                } else {

                                    response = {
                                        "aaData": [],
                                        "iTotalRecords": 0,
                                        "iTotalDisplayRecords": 0
                                    };

                                }
                                fnCallback(response);

                            }
                        });
                    },
                    createdRow: function(row, data, index) {}
                });

                return {
                    searchData: function() {
                        $('#search').on('click', function(e) {

                            window.location = '/notification?search=' + textSearch;

                        });
                    },
                    init: function() {
                        Feature.searchData();
                    }
                }
            })();

            jQuery(document).ready(function() {
                Feature.init();
            });
        </script>